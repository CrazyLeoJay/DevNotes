# 手游SDK设计

## SDK

从SDK出发，主要原理是对外提供一个单例，并且提供调用API，实现基本功能。在接口设计上主要有：

- 不同的功能模块：初始化、登录、注册、付费、悬浮球、退出框等
- 对外开放的Api。将不同功能模块整理成对外开放的接口模块。
- 内部模块互调。在实际开发过程中，不同模块之间有一定的耦合，通过接口进行代理，当模块被移除时，可以统一处理异常情况，达到解耦的目的。
- 全局工具类。通用方法，代码全局任何地方都可以直接通过单例使用。包括但不限于：哈希值计算、加密解密、activity相关操作工具类、权限请求封装、网络请求封装、系统参数获取等。
- 三方插件动态拓展。通过反射+接口实现+项目外lib实现，方便热拔插。常见的有：
  - 媒体上报渠道
  - 硬核联盟各渠道SDK接入

## 模块设计

- 是一组对外开放的接口。
- 需要按照功能模块进行划分，但最最终使用时，要归于一个接口类型集合中，即最终生成的接口类，必须继承与所有模块接口。
- 每个模块的接口，都要有统一的父类标识接口，方便在一些场景传参时区分接口的类型。
- 模块需要设计接口，存在一种情况是，模块调用存在，但具体实现可能不存在，需要处理这部分逻辑，一般情况是要给到提示。
- 

## 多渠道SDK设计

- 有些业务存在对外的多种资质，可能需要呈现不同的SDK类型和引用。
- 一种是每种渠道都有独立系统，一般是联运需求，需要单独开发一些专属功能，但实际功能由手游SDK实现，需要进行嵌套。手游SDK可以是自家的手游SDK，也可以三方SDK提供。
- 一种是渠道本身属于手游SDK的变种，仅替换名称和引用，功能完全一致。
- 有一些三方硬核渠道，虽然使用了平台所有功能，但需要对应数据在手游平台进行留存，所以是作为拓展进行接入和调用，但和对外SDK接口有一对一的调用关系。
- 

## 组件内部事件调用

- 组件之间存在调用关系，但为了解耦不能让其直接调用。
- 组件之间的的调用Api不需要对外开放，所以不能与SDK主接口的Api放在一起。

## 生命周期组件设计

- 设计一些注解，这些注解可以动态注册到模组内部的方法上，并且可以在声明周期方法调用时，同步调用。

## 全局工具类

- 单例
- 全局工具，即在任意地方，都可能调用。比如哈希值计算、加解密算法、类操作、Json操作、接口操作。
- 模块内部事件通知实例获取。通过全局工具，可以快捷调用模块中的各种事件。

## 三方插件动态拓展

这里的插件主要指：

- 有或者没有都不影响核心手游SDK的正常运行。
- 一些仅在部分渠道上实现的功能。
- 三方合作的SDK，仅在某些渠道上生效。
- 一些特定工功能，仅使用一段时间，不需要代码留存在SDK中。

所以在制作这个模块时要提供：

- 设计功能模块在SDK core中的接口。这部分是必须存在的，去定义模块如何使用。
- 设计动态代理的默认实现。
